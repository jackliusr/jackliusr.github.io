---
title: Setup visual studio 2022 in restricted environment
date: 2024-07-23T10:10:00+08:00
categories:
- tech
tags:
- visual studio
---

. uninstall vs and vsinstaller
. restart machine
. download below two vs cpp redist and install first before install visual studio
	https://aka.ms/vs/17/release/vc_redist.x86.exe
	https://aka.ms/vs/17/release/vc_redist.x64.exe

. download the latest version of VisualStudioSetup.exe from https://c2rsetup.officeapps.live.com/c2r/downloadVS.aspx?sku=professional&channel=Release&version=VS2022&source=VSLandingPage&cid=2030:a4e034a4e73f4c1cb41366109a953e4d
. choose download all and install when installing visual studio after choosing components to install
. Clear Visual Studio Component Cache
.. Close Visual Studio (ensure devenv.exe is not present in the Task Manager)
.. Delete the %USERPROFILE%\AppData\Local\Microsoft\VisualStudio\11.0\ComponentModelCache directory
.. Restart Visual Studio. 
